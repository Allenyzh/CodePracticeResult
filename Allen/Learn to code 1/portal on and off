var gem = 0
var sw = 0
while sw != 1 || gem != 7 {
    if isOnGem {
        collectGem()
        gem += 1
    }else if isOnClosedSwitch {
        toggleSwitch()
        sw += 1
    }else if gem < 4 {
        purplePortal.isActive = false
    }else {
        purplePortal.isActive = true
    }
    if sw == 1 {
        purplePortal.isActive = false
    }
    if isBlocked && isBlockedRight {
        turnLeft()
    }else if isBlockedRight {
        moveForward()
    }else {
        turnRight()
        moveForward()
    }
}
